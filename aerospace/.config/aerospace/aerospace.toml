start-at-login = true
after-login-command = []
after-startup-command = []

on-focused-monitor-changed = ['move-mouse monitor-lazy-center']
on-focus-changed = "move-mouse window-lazy-center"

# Notify sketchybar on workspace change
exec-on-workspace-change = ['/bin/bash', '-c', 'sketchybar --trigger aerospace_workspace_change']

# Normalizations
enable-normalization-flatten-containers = true
enable-normalization-opposite-orientation-for-nested-containers = true

# Layout settings
default-root-container-layout = 'tiles'
default-root-container-orientation = 'auto'

# Possible values: (qwerty|dvorak|colemak)
[key-mapping]
preset = 'qwerty'

# Gaps
[gaps]
outer.top = 40  # space for sketchybar
outer.bottom = 2
inner.horizontal = 2
inner.vertical = 2
outer.left = 2
outer.right = 2

# ==============================================================================
# PREFIX MODE (ctrl+b as prefix, like tmux)
# ==============================================================================

[mode.main.binding]
ctrl-b = 'mode prefix'

# Workspace switching (alt + number) - direct access without prefix
alt-1 = 'workspace 1'
alt-2 = 'workspace 2'
alt-3 = 'workspace 3'
alt-4 = 'workspace 4'
alt-5 = 'workspace 5'
alt-6 = 'workspace 6'
alt-7 = 'workspace 7'
alt-8 = 'workspace 8'
alt-9 = 'workspace 9'
alt-0 = 'workspace 10'

# Move Window to Workspace
alt-shift-1 = 'move-node-to-workspace 1'
alt-shift-2 = 'move-node-to-workspace 2'
alt-shift-3 = 'move-node-to-workspace 3'
alt-shift-4 = 'move-node-to-workspace 4'
alt-shift-5 = 'move-node-to-workspace 5'
alt-shift-6 = 'move-node-to-workspace 6'
alt-shift-7 = 'move-node-to-workspace 7'
alt-shift-8 = 'move-node-to-workspace 8'
alt-shift-9 = 'move-node-to-workspace 9'

alt-tab = 'workspace-back-and-forth'
alt-shift-tab = 'move-workspace-to-monitor --wrap-around next'

[mode.prefix.binding]
# Exit prefix mode with escape
esc = ['reload-config', 'mode main']

# ==============================================================================
# WINDOW FOCUS (prefix + hjkl)
# ==============================================================================

h = 'focus left'
j = 'focus down'
k = 'focus up'
l = 'focus right'

# Focus monitors
w = 'focus-monitor left'
e = 'focus-monitor right'

# ==============================================================================
# WINDOW RESIZE (prefix + shift + hjkl)
# ==============================================================================

shift-h = 'resize width -50'
shift-j = 'resize height +50'
shift-k = 'resize height -50'
shift-l = 'resize width +50'

# ==============================================================================
# WINDOW MOVE/SWAP (prefix + ctrl + hjkl)
# ==============================================================================

ctrl-h = 'move left'
ctrl-j = 'move down'
ctrl-k = 'move up'
ctrl-l = 'move right'

# ==============================================================================
# JOIN WITH NEIGHBOR (prefix + alt + hjkl) - similar to yabai warp
# ==============================================================================

alt-h = ['join-with left', 'mode main']
alt-j = ['join-with down', 'mode main']
alt-k = ['join-with up', 'mode main']
alt-l = ['join-with right', 'mode main']

# ==============================================================================
# LAYOUT OPERATIONS (prefix + key)
# ==============================================================================

# Rotate layout (flatten and re-tile)
r = ['flatten-workspace-tree', 'mode main']
# Toggle between horizontal and vertical
o = ['layout tiles horizontal vertical', 'mode main']
# Accordion layout
a = ['layout accordion horizontal vertical', 'mode main']
# Balance windows
b = ['balance-sizes', 'mode main']
# Close all windows but current
backspace = ['close-all-windows-but-current', 'mode main']

# ==============================================================================
# WINDOW TOGGLES (prefix + key)
# ==============================================================================

# Maximize (fullscreen)
m = ['fullscreen', 'mode main']
# Toggle float
t = ['layout floating tiling', 'mode main']

# ==============================================================================
# MOVE WINDOW BETWEEN MONITORS (prefix + d/f)
# ==============================================================================

d = ['move-node-to-monitor left', 'focus-monitor left', 'mode main']
f = ['move-node-to-monitor right', 'focus-monitor right', 'mode main']

# ==============================================================================
# APP-SPECIFIC RULES
# ==============================================================================

[[on-window-detected]]
if.app-id = 'com.apple.systempreferences'
run = 'layout floating'

[[on-window-detected]]
if.app-id = 'com.apple.finder'
run = 'layout floating'

# Always fullscreen
[[on-window-detected]]
if.app-id = 'com.mitchellh.ghostty'
run = 'fullscreen'
